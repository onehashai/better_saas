{
 "accept_payment": 0,
 "allow_comments": 0,
 "allow_delete": 0,
 "allow_edit": 0,
 "allow_incomplete": 0,
 "allow_multiple": 0,
 "allow_print": 0,
 "amount": 0.0,
 "amount_based_on_field": 0,
 "button_label": "Get Started",
 "client_script": "var otp=\"\";\nvar key_value = frappe.datetime.get_datetime_as_string();\nvar is_valid_email=false;\nvar is_valid_subdomain = false;\nvar is_valid_form = false;\n\nfrappe.web_form.set_value(\"key\",key_value);\n$(frappe.web_form.get_field(\"password\").input).attr('type', 'password');\n$(frappe.web_form.get_field(\"confirm_password\").input).attr('type', 'password')\n\n/*\n * Customize webform design to incorporate\n */\n\n$(\".page-header-actions-block\").hide();\n$(\".web-form-footer\").removeClass(\"pull-right\");\n$(\".web-form-footer\").css({\"text-align\":\"Center\"});\n$(\"#page-saas-signup\").css({\"margin\":\"0 auto\", \"max-width\":\"600px\"});\n$(\"main\").addClass(\"card card-body\");\n\nfrappe.web_form.on('subdomain', (field, value) => {\n    frappe.call({\n        method: \"better_saas.better_saas.doctype.saas_user.saas_user.check_subdomain_avai\",\n        args: {\n            \"subdomain\": value\n        },\n        callback: function(r){\n            if (value != \"\") {\n                if (r.message.status === \"True\") {\n                    $(field.wrapper).find(\".help-box\").text(\"Subdomain available\");\n                    $(field.wrapper).find(\".help-box\").attr(\"style\", \"color: green !important\");\n                    is_valid_subdomain = true;\n                    initOTP();\n                }\n                if (r.message.status === \"False\") {\n                    frappe.web_form.set_value(\"subdomain\", \"\");\n                    is_valid_subdomain = false;\n                    $(field.wrapper).find(\".help-box\").text(\"Subdomain not available\");\n                    $(field.wrapper).find(\".help-box\").attr(\"style\", \"color: red !important\");\n                }\n            } else {\n                $(field.wrapper).find(\".help-box\").text();\n            }\n            \n        }\n    })\n});\nfrappe.web_form.on('email', (field, value) => {\n    frappe.call({\n        method: \"better_saas.better_saas.doctype.saas_user.saas_user.check_email_avai\",\n        args: {\n            \"email\": value        \n        },\n        callback: function(r){\n            if (value != \"\") {\n                if (r.message.status === \"True\") {\n                    $(field.wrapper).find(\".help-box\").text(\"Valid Email\");\n                    $(field.wrapper).find(\".help-box\").attr(\"style\", \"color: green !important\");\n                    is_valid_email = true;\n                    initOTP();\n                }\n                if (r.message.status === \"False\") {\n                    is_valid_email = false;\n                    frappe.web_form.set_value(\"email\", \"\");\n                    $(field.wrapper).find(\".help-box\").text(\"Email Already Taken\");\n                    $(field.wrapper).find(\".help-box\").attr(\"style\", \"color: red !important\");\n                }\n            } else {\n                $(field.wrapper).find(\".help-box\").text();\n            }\n        }\n    })\n});\n\n\nfrappe.web_form.on('mobile', (field, value) => {\n initOTP();   \n});\n\nfrappe.web_form.validate = () => {\n\tif(frappe.web_form.get_field(\"password\").value != frappe.web_form.get_field(\"confirm_password\").value){\n\t\tfrappe.throw(\"Passwords Dont Match !!\")\n\t\tfrappe.web_form.set_value(\"confirm_password\", \"\");\n\t\treturn false;\n    }\n\n    if(!is_valid_email){\n        frappe.throw(\"Please enter valid Email.\");\n        return false;\n    }\n\n    if(!is_valid_subdomain){\n        frappe.throw(\"Please enter valid subdomain.\");\n        return false;\n    }\n    \n    if(frappe.web_form.get_value(\"otp\")!=otp){\n        frappe.throw(\"Please enter a valid OTP\");\n        return false;\n    }\n}\n\nfunction initOTP(){\n    let mobile = frappe.web_form.get_value('mobile');\n    if(mobile.length==10 && is_valid_email && is_valid_subdomain){\n        frappe.web_form.set_df_property('otp', 'hidden', false);\n        generateOTP();\n        sendOTP();\n    }\n}\n\nfunction generateOTP() {\n    var string = '0123456789';\n    var len = string.length;\n    for (let i = 0; i < 4; i++) {\n        otp += string[Math.floor(Math.random() * len)];\n    }\n}\n\nfunction sendOTP(){\n    var message = otp+\" is OTP to complete your registration for onehash.\";\n    var email = frappe.web_form.get_value(\"email\");\n    var mobile = [];\n    mobile.push(frappe.web_form.get_value(\"mobile\"));\n    frappe.call({\n        method: \"frappe.core.doctype.communication.email.make\",\n        args: {\n            recipients: email,\n            sender:\"alerts@onehash.ai\",\n            content: message,\n            subject: \"Verify Account\",\n            send_email: 1,\n            communication_medium: \"Email\"\n        },\n        callback: function(r) {\n            if (r.message.status === \"True\") {\n                show_alert(\"Please check your email or Mobile for OTP.\");\n            }\n        }\n    });\n    \n    frappe.call({\n            method: \"frappe.core.doctype.sms_settings.sms_settings.send_sms\",\n            args: {\n                \"receiver_list\": mobile,\n                \"msg\": message\n            }\n    });\n}",
 "creation": "2020-03-04 20:06:35.218935",
 "currency": "INR",
 "doc_type": "Saas User",
 "docstatus": 0,
 "doctype": "Web Form",
 "idx": 0,
 "introduction_text": "<div>Open Source Software for Modern Businesses</div>",
 "is_standard": 1,
 "login_required": 0,
 "max_attachment_size": 0,
 "modified": "2020-04-16 00:54:45.653933",
 "modified_by": "Administrator",
 "module": "Better Saas",
 "name": "saas-signup",
 "owner": "Administrator",
 "payment_button_label": "Buy Now",
 "published": 1,
 "route": "signup",
 "route_to_success_link": 0,
 "show_attachments": 0,
 "show_in_grid": 0,
 "show_sidebar": 0,
 "sidebar_items": [],
 "success_message": "",
 "success_url": "/login",
 "title": "Get Started",
 "web_form_fields": [
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "first_name",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "First Name",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "last_name",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Last Name",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "email",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Email",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "mobile",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Mobile",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "default": "Subdomain",
   "fieldname": "domain_type",
   "fieldtype": "Select",
   "hidden": 1,
   "label": "Domain Type",
   "max_length": 0,
   "max_value": 0,
   "options": "Subdomain",
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "",
   "fieldtype": "Column Break",
   "hidden": 0,
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "password",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Password",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "confirm_password",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Confirm Password",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "subdomain",
   "fieldtype": "Data",
   "hidden": 0,
   "label": "Subdomain",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "otp",
   "fieldtype": "Data",
   "hidden": 1,
   "label": "OTP",
   "max_length": 6,
   "max_value": 0,
   "read_only": 0,
   "reqd": 1,
   "show_in_filter": 0
  },
  {
   "allow_read_on_all_link_options": 0,
   "fieldname": "key",
   "fieldtype": "Data",
   "hidden": 1,
   "label": "Key",
   "max_length": 0,
   "max_value": 0,
   "read_only": 0,
   "reqd": 0,
   "show_in_filter": 0
  }
 ]
}